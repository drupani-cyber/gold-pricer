<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gold Treasure Custom Gold Estimate</title>
<style>
:root { --pad: 16px; --radius: 16px; --font: -apple-system, system-ui, Segoe UI, Roboto, Arial, sans-serif; }
* { box-sizing: border-box; font-family: var(--font); }
body { margin:0; background:#f6f7fb; color:#0f172a; font-size: clamp(16px,2vw,18px); }
header { position: sticky; top:0; z-index:10; padding:12px var(--pad); background:#fff; box-shadow:0 2px 8px rgba(0,0,0,.06); display:flex; align-items:center; gap:12px; }
.title { font-weight:800; font-size: clamp(18px,2.2vw,24px); flex:1; }
.logo-small { width:90px; opacity:.9; }
.wrap { max-width:1000px; margin:0 auto; padding:var(--pad); }
.card { background:#fff; border-radius:16px; box-shadow:0 6px 22px rgba(0,0,0,.08); padding:var(--pad); }
label { font-size:.9em; color:#475569; display:block; margin-bottom:4px; }
input,select,button { width:100%; padding:14px; border-radius:12px; border:1px solid #d1d5db; font-size:clamp(16px,2vw,18px); }
input[type="checkbox"] { width:auto; transform:scale(1.3); margin-right:8px; }
.grid { display:grid; gap:14px; }
.g-3 { grid-template-columns:1fr 1fr 1fr; }
@media (max-width:800px){ .g-3{ grid-template-columns:1fr; } }
.kv { display:grid; grid-template-columns:1fr auto; gap:8px; align-items:center; }
.value { font-weight:800; text-align:right; font-size:1.08em; }
.muted { color:#6b7280; font-size:.95em; }
.section-title { margin-top:10px; margin-bottom:6px; font-weight:800; color:#0f172a; }
.btns { display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:12px; margin-top:16px; }
button.primary { background:#0ea5e9; color:#fff; border:none; }
button.danger { background:#fff; border:2px solid #ef4444; color:#ef4444; }
button.outline { background:#fff; border:2px solid #0ea5e9; color:#0ea5e9; }
.total { font-size:1.35em; color:#0ea5e9; }
.row { display:flex; gap:10px; align-items:center; flex-wrap: wrap; }
.pill { background:#e0f2fe; color:#075985; border-radius:999px; padding:4px 10px; font-size:.85em; display:none; }
.pill.err { background:#fee2e2; color:#991b1b; border:1px solid #fecaca; }
.disabled { background:#f1f5f9; color:#6b7280; }
.alert { display:none; margin:12px 0; padding:10px 12px; border-radius:12px; font-weight:600; }
.alert.error { background:#fee2e2; color:#991b1b; border:1px solid #fecaca; }
.guard { border:3px solid #ef4444; border-radius:18px; padding:14px; margin-top:14px; position:relative; }
.guard::before { content:"Fill only inside the red box"; position:absolute; top:-12px; left:16px; background:#fff; padding:0 8px; color:#991b1b; font-weight:800; font-size:12px; }
#printLayout { display:none; }
#printLayout .logo { width:140px; }
#printLayout h1 { font-size:22px; margin:6px 0 2px; text-align:center; }
#printLayout .muted { color:#64748b; text-align:center; margin:0 0 10px; font-size:13px; }
#printLayout table { width:100%; border-collapse:collapse; margin-top:10px; font-size:14px; }
#printLayout td { padding:8px 4px; border-bottom:1px solid #eceff4; }
#printLayout .right { text-align:right }
#printLayout .total { font-weight:800; font-size:17px }
@media print {
  @page { size: A4 portrait; margin:16mm; }
  header, .card, .btns, .wrap > :not(#printLayout) { display:none !important; }
  body { background:#fff; }
  #printLayout { display:block !important; }
}
</style>
</head>
<body>
<header>
  <div class="title">Gold Treasure Custom Gold Estimate</div>
  <a href="https://www.thegoldtreasure.com" target="_blank" rel="noopener"><img class="logo-small" src="https://www.thegoldtreasure.com/assets/logo.png" alt="Gold Treasure Logo"></a>
</header>

<div class="wrap">
  <div class="card">
    <h2 class="section-title">Estimate Form</h2>
    <div class="guard">
      <div class="grid g-3">
        <div>
          <label>24K Gold Spot Price (per oz)</label>
          <input id="spot" type="number" step="0.01" value="4100">
        </div>
        <div>
          <label>Labor ($/g)</label>
          <input id="labor" type="number" step="0.01" value="25">
        </div>
        <div>
          <label>Loss %</label>
          <input id="loss" type="number" step="0.1" value="10">
        </div>
      </div>
    </div>
    <div class="btns">
      <button id="calc" class="primary">Calculate</button>
      <button id="clear" class="outline">Clear</button>
      <button id="print" class="outline">Print</button>
      <button id="auto" class="outline">Auto spot (LBMA + $100)</button>
    </div>
  </div>

  <div id="printLayout">
    <img class="logo" src="https://www.thegoldtreasure.com/assets/logo.png" alt="Gold Treasure Logo">
    <h1>Gold Treasure</h1>
    <p class="muted">(956)401-4010<br>Rate good for 1 week only<br>Customer signature ____________________________</p>
    <table>
      <tr><td>Product Weight (g)</td><td class="right" id="finalWeight"></td></tr>
      <tr><td>Scrap Given by Customer 10K (g)</td><td class="right" id="scrap10"></td></tr>
      <tr><td>Scrap Given by Customer 14K (g)</td><td class="right" id="scrap14"></td></tr>
      <tr><td class="total">Total Estimate</td><td class="right total" id="total"></td></tr>
    </table>
  </div>
</div>

<script>
const LBMA_PROXY_URL = "https://script.google.com/macros/s/AKfycbw4VVdNm2hTMPa4-zDEh2LY73_fTTbINHOg3GuggbqT-1VDpj5wF97TRq1pNyW1MTfi/exec";

document.getElementById("auto").addEventListener("click", async () => {
  const btn = document.getElementById("auto");
  btn.textContent = "Fetching...";
  try {
    const res = await fetch(LBMA_PROXY_URL);
    const data = await res.json();
    if (data.price) {
      document.getElementById("spot").value = data.price.toFixed(2);
      btn.textContent = "Auto spot updated";
      btn.classList.remove("err");
    } else {
      btn.textContent = "Auto failed";
      btn.classList.add("err");
    }
  } catch (e) {
    btn.textContent = "Auto failed";
    btn.classList.add("err");
  }
});
</script>
</body>
</html>
